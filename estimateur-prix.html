<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estimateur de prix</title>

    <!-- IMPORTS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Assistant:wght@200..800&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
        rel="stylesheet">



    <link rel="stylesheet" href="./styles/order-form.css">
    <link rel="stylesheet" href="./styles/estimateur.css">


    <!-- IMPORTS JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/3.0.1/jspdf.umd.min.js"
        integrity="sha512-ad3j5/L4h648YM/KObaUfjCsZRBP9sAOmpjaT2BDx6u9aBrKFp7SbeHykruy83rxfmG42+5QqeL/ngcojglbJw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/5.0.2/jspdf.plugin.autotable.min.js"
        integrity="sha512-JizZOUNesiGhMcp9fsA/9W31FOat6QysBM8hSj6ir8iIANIUJ2mhko7Lo1+j0ErftmJ8SebMZLm9iielKjeIEQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
        integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>


</head>

<body>

    <section id="order-form-v2">
        <main class="main">

            <div id="loadingSpinner" style="display:flex;align-items:center;justify-content:center;height:100vh;">
                <div
                    style="border:4px solid #ccc;border-top:4px solid #333;border-radius:50%;width:40px;height:40px;animation:spin 1s linear infinite;">
                </div>
            </div>
            <style>
                @keyframes spin {
                    from {
                        transform: rotate(0deg);
                    }

                    to {
                        transform: rotate(360deg);
                    }
                }
            </style>


            <button id="btnReset" type="button">Réinitialiser</button>

            <div class="card">
                <div class="title_section">
                    <h2>Configurateur ISOTUILES</h2>
                    <small id="savedState" style="color:var(--muted)"></small>
                </div>

                <div class="progress"><i id="progressBar"></i></div>

                <div class="steps" id="stepsContainer">
                    <!-- Step 1: Choisir panneau -->
                    <section class="step" data-step="1" id="step-1">
                        <h3>1 • Choisissez votre panneau</h3>
                        <div class="field">
                            <label for="selectPanneau">Modèle / Variante
                                <select id="selectPanneau">
                                    <option>Choisir un panneau</option>
                                </select></label>
                        </div>
                        <div class="field">
                            <label>
                                <input type="number" id="inputLongueur" min="2.1" max="12.25" step="0.01" value="2.10">
                                Longueur par panneau (m)
                            </label>
                        </div>
                        <div class="field">
                            <label>
                                <input type="number" id="inputLongueur" min="2.1" max="12.25" step="0.01" value="2.10">
                                Longueur par panneau (m)
                            </label>
                        </div>
                        <div class="field">
                            <label>
                                <input type="number" id="inputQuantite" min="1" step="1" value="1">
                                Quantité de panneaux
                            </label>
                        </div>
                    </section>

                    <!-- Step 2: Accessoires -->
                    <section class="step hidden" data-step="2" id="step-2">
                        <h3>2 • Accessoires associés</h3>
                        <div id="accessoriesList"></div>
                    </section>

                    <!-- Step 3: Options livraison / contact -->
                    <section class="step hidden" data-step="3" id="step-3">
                        <h3>3 • Livraison & contact</h3>
                        <div class="field"><label>
                                <input type="text" id="inputPostal" placeholder="Ex: 33480">
                                Code postal (pour info transport)
                            </label>
                        </div>
                        <div class="field"><label>
                                <input type="text" id="inputName">
                                Nom / Société</label>
                        </div>
                        <div class="field"><label>
                                <input type="email" id="inputEmail">
                                Email</label>
                        </div>
                        <div class="field"><label>
                                <input type="text" id="inputPhone">
                                Téléphone (optionnel)</label>
                        </div>
                    </section>

                    <!-- Step 4: Récapitulatif -->
                    <section class="step hidden" data-step="4" id="step-4">
                        <h3>4 • Récapitulatif & devis</h3>
                        <div id="recapDetails"></div>
                        <div style="margin-top:12px;display:flex;gap:8px">
                            <button id="btnDownloadPdf" class="secondary">Télécharger le devis (PDF)</button>
                            <button id="btnSendToCart">Valider et ajouter au panier</button>
                        </div>
                    </section>
                </div>


            </div>
        </main>



        <div class="overlay">
            <div class="controls">
                <button id="btnPrev" class="secondary">Précédent</button>
                <div style="margin-left:auto;display:flex;gap:8px">
                    <button id="btnNext">Suivant</button>
                </div>
            </div>
            <div>
                <h3>Panier & estimation</h3>
                <div class="lines" id="overlayLines"></div>
                <div class="total">
                    <div>Estimation (HT) : <span id="overlayTotalHt">0.00 €</span></div>
                    <div style="font-size:0.9rem;color:var(--muted);margin-top:6px">TVA : <span id="vatRate"></span>
                    </div>
                </div>
            </div>
        </div>
    </section>


    <section id="estimateur_container">
        <img id="calculator-icon" src="./media/calculator.svg">

        <h2>Calculateur de coûts</h2>
        <h3>Remplissez les informations ci-dessous et obtenez en temps réel une estimation personnalisée de votre
            commande.</h3>


        <!-- Type de produit -->
        <fieldset class="select_container">
            <label class="required">Type de produit</label>
            <div class="form_choices" id="typePanneauContainer">
                <div class="form-check">
                    <input class="maj_height" type="radio" id="type1" name="typePanneau" value="romaneCanal" checked>
                    <label for="type1">
                        Romane Canal
                    </label>
                    <div class="illustration">
                        <img src="https://cdn.shopify.com/s/files/1/0909/7605/9715/files/rouge.webp?v=1744188622">
                    </div>
                </div>
                <div class="form-check">
                    <input class="maj_height" type="radio" id="type2" name="typePanneau" value="tuilesPlates">
                    <label for="type2">Tuiles Plates</label>
                    <div class="illustration">
                        <img
                            src="https://panotuiles.fr/panneaux-sandwich-imitation-tuiles-gironde-bordeaux-couverture-isole/p102.webp">
                    </div>
                </div>
                <div class="form-check">
                    <input class="maj_height" type="radio" id="type3" name="typePanneau" value="bacAcier">
                    <label for="type3">Bac Acier</label>
                    <div class="illustration">
                        <img
                            src="https://isotuiles.fr/cdn/shop/files/Bac_acier_-_Metal_argente_-_RAL_9006.png?v=1744153063">
                    </div>
                </div>
            </div>
        </fieldset>

        <!-- Couleur (sera rempli dynamiquement) -->
        <fieldset class="select_container">
            <label class="required">Couleur</label>
            <div class="form_choices" id="couleurContainer"></div>
        </fieldset>

        <!-- Épaisseur (sera rempli dynamiquement) -->
        <fieldset class="select_container">
            <label class="required">Épaisseur</label>
            <div class="form_choices" id="epaisseurContainer"></div>
        </fieldset>





        <!-- Tableau Longueur / Quantité / Surface -->
        <div class="select_container">
            <p class="select_title">Longueur & quantité</p>
            <table id="tablePanneaux">
                <thead>
                    <tr>
                        <th>Longueur (mm)</th>
                        <th>Quantité</th>
                        <th>Surface (m²)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <select class="longueur">
                                <option value="">--</option>
                                <option value="2100">2.100 mm</option>
                                <option value="2450">2.450 mm</option>
                                <option value="2800">2.800 mm</option>
                                <option value="3150">3.150 mm</option>
                                <option value="3500">3.500 mm</option>
                                <option value="3850">3.850 mm</option>
                                <option value="4200">4.200 mm</option>
                                <option value="4550">4.550 mm</option>
                                <option value="4900">4.900 mm</option>
                                <option value="5250">5.250 mm</option>
                                <option value="5600">5.600 mm</option>
                                <option value="5950">5.950 mm</option>
                                <option value="6300">6.300 mm</option>
                                <option value="6650">6.650 mm</option>
                                <option value="7000">7.000 mm</option>
                                <option value="7350">7.350 mm</option>
                                <option value="7700">7.700 mm</option>
                                <option value="8050">8.050 mm</option>
                                <option value="8400">8.400 mm</option>
                                <option value="8750">8.750 mm</option>
                                <option value="9100">9.100 mm</option>
                                <option value="9450">9.450 mm</option>
                                <option value="9800">9.800 mm</option>
                                <option value="10150">10.150 mm</option>
                                <option value="10500">10.500 mm</option>
                                <option value="10850">10.850 mm</option>
                                <option value="11200">11.200 mm</option>
                                <option value="11550">11.550 mm</option>
                                <option value="11900">11.900 mm</option>
                                <option value="12250">12.250 mm</option>
                            </select>
                        </td>
                        <td><input type="number" step="1" class="quantite"></td>
                        <td class="surface">0</td>
                    </tr>
                </tbody>
            </table>
            <button id="ajouterLigne">Ajouter une longueur</button>
        </div>


        <!-- Tableau Longueur / Quantité / Surface -->
        <div class="select_container">
            <p class="select_title">Accessoires</p>
            <button id="afficherAccessoires" class="maj_height" onclick="DisplayAccessories()">Ajouter des
                accessoires</button>
            <div id="listeAccessoires" style="display: none;"></div>
        </div>




        <div class="total">
            <!-- Tableau des prix -->
            <div>
                <div class="toggle_btn maj_height">
                    <img src="https://img.icons8.com/ios-glyphs/1000/chevron-up.png">
                    <span>Tableau des prix</span>
                </div>
                <div id="tablePrix" class="tableContainer">
                    <table>
                        <thead>
                            <tr>
                                <th>Produit</th>
                                <th>Couleur</th>
                                <th>Épaisseur</th>
                                <th>Prix</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- Détail commande -->
            <div>
                <div class="toggle_btn maj_height">
                    <img src="https://img.icons8.com/ios-glyphs/1000/chevron-up.png">
                    <span>Détail commande</span>
                </div>
                <div id="tableDetail" class="tableContainer">
                    <table>
                        <thead>
                            <tr>
                                <th>Produit</th>
                                <th>Épaisseur</th>
                                <th>Longueur</th>
                                <th>Quantité</th>
                                <th>Surface</th>
                                <th>Coût unitaire</th>
                                <th>Prix total</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                    <p class="info-text">Pour afficher, ajoutez les paramètres longueur et quantité</p>
                </div>
            </div>
        </div>

        <div id="resultat-estimation" class="row">
            <div class="col">
                <h4>Coût global estimé</h4>
                <span>pour votre commande (HT)</span>
            </div>

            <span id="prixTotal">0 €</span>
        </div>

        <div class="col">
            <p>Pour un devis précis complet, contactez-nous.</p>
            <div class="btn_container">
                <button class="btn-1 maj_height" id="exportPdf">Exporter en PDF</button>
                <button onclick="window.open('https://isotuiles.fr/pages/conctactez-nous')" class="btn-1">Nous
                    contacter</button>
            </div>
            <div id="insert_pdf_options"></div>
        </div>
    </section>






    <section id="avantages">
        <!-- <h2>Pourquoi utiliser cet outil ?</h2> -->
        <ul>
            <li><b>Rapide :</b> résultat instantané, sans attendre un devis manuel.</li>

            <li><b>Simple :</b> aucune compétence technique requise, il suffit de remplir le formulaire.</li>

            <li><b>Transparent :</b> détails du calcul affichés ligne par ligne.</li>

            <li><b>Pratique :</b> possibilité d’exporter votre estimation en PDF.</li>

            <li><b>Gratuit :</b> accessible à tous, sans engagement.</li>
        </ul>
    </section>


    <section id="presentation">
        <h6>Calculateur de coûts</h6>
        <h2>Estimez le budget global de votre projet.</h2>

        <p>
            Notre estimateur de prix vous offre une solution simple et rapide pour évaluer le budget de votre commande.
            En choisissant vos paramètres (type de produit, couleur, dimensions, quantités…), vous obtenez
            instantanément
            une estimation du coût total ainsi qu’un récapitulatif détaillé.
            Cet outil est conçu pour vous aider à préparer vos projets en toute sérénité et à mieux anticiper vos
            investissements avant de passer commande.
        </p>
    </section>

    <section id="fonctionnement">
        <h2>Comment ça marche ?</h2>
        <div class="col">
            <img width="500" height="auto" src="./media/estimateur-commande-preview-video.png">
            <div class="steps_container">
                <div class="row">
                    <div>
                        <h4>01.<br>Choisissez vos options</h4>
                        <p>Sélectionnez le produit, la couleur, l’épaisseur et les
                            dimensions</p>
                    </div>
                    <div>
                        <h4>02.<br>Indiquez vos besoins</h4>
                        <p>Précisez les quantités et longueurs souhaitées</p>
                    </div>
                </div>
                <div class="row">
                    <div>
                        <h4>03.<br>Obtenez votre estimation</h4>
                        <p>L’outil calcule automatiquement la surface et le coût total</p>
                    </div>
                    <div>
                        <h4>04.<br>Lisez et téléchargez votre devis</h4>
                        <p>Vous pourrez à la fin enregistrer votre estimation en PDF</p>
                    </div>
                </div>
            </div>
            <div class="last_step">
                <img src="https://img.icons8.com/ios/500/approval.png">
                <p>Lorsque vous réalisez votre devis en ligne, vous nous aidez à traiter votre demande plus
                    efficacement. En nous l’envoyant, nous disposons immédiatement de toutes les informations
                    nécessaires pour enregistrer votre commande et comprendre au mieux vos besoins.</p>
            </div>
        </div>
    </section>

    <section id="questions-reponses">
        <h2>FAQ / Infos pratiques sur l'outil</h2>
        <p>Trouvez ici les réponses aux questions les plus fréquentes :</p>
        <div id="insert_estimateur_faq"></div>
        <p>Vous avez encore des questions auxquelles vous n'avez pas trouvé de réponse ? <br>Contactez notre équipe pour
            plus de précisions.</p>
    </section>

    <script>
        const FAQ = [
            {
                q: "Qu’est-ce que l’estimateur de prix ?",
                r: "L’estimateur de prix est un outil en ligne qui vous permet de calculer automatiquement le coût global de votre future commande en fonction de vos choix (produit, couleur, dimensions, quantités, etc.) le tout 100% gratuit et en ligne."
            },
            {
                q: "Comment utiliser l’estimateur de prix ?",
                r: "Sélectionnez le type de produit, la couleur, l’épaisseur, les longueurs et les quantités souhaitées. L’outil calcule ensuite la surface totale et le prix estimé, avec un tableau récapitulatif clair et détaillé."
            },
            {
                q: "L’estimation est-elle un devis officiel ?",
                r: "Non. L’estimateur fournit une approximation budgétaire pour vous donner de la visibilité avant de passer commande. Pour un devis officiel et personnalisé, contactez notre équipe."
            },
            {
                q: "Puis-je sauvegarder ou partager mon estimation ?",
                r: "Oui ! Vous pouvez exporter votre estimation au format PDF, afin de les conserver ou de les partager facilement avec notre équipe lors de la demande d'un devis officiel."
            },
            {
                q: "Est-ce que l’estimation prend en compte les promotions ou réductions ?",
                r: "L’estimateur calcule un prix standard basé sur nos tarifs en vigueur. Les éventuelles réductions, offres spéciales ou frais de livraison peuvent être ajoutés lors de la commande définitive."
            },
            {
                q: "Puis-je modifier mon estimation après l’avoir générée ?",
                r: "Bien sûr. Vous pouvez changer vos choix (produit, couleur, dimensions, quantités) à tout moment, et l’outil mettra automatiquement à jour le tableau et le prix total."
            },
            {
                q: "Est-ce que je peux utiliser l’estimateur sur mobile ?",
                r: "Oui, l’outil est conçu pour être responsive et fonctionne aussi bien sur ordinateur, tablette que sur smartphone."
            },
            {
                q: "Puis-je envoyer mon estimation par mail ?",
                r: "Pas directement depuis l’outil pour l’instant, mais vous pouvez télécharger le PDF et l’envoyer facilement par e-mail."
            }
        ];

        // Génération HTML
        var faq_html = "";
        FAQ.forEach((qr, index) => {
            faq_html += `
            <div class="faq-item maj_height">
                <div class="faq-question" data-id="${index}">
                    <span>${qr.q}</span>
                    <span class="arrow">+</span>
                </div>
                <div class="faq-answer" style="display: none;">
                    <p>${qr.r}</p>
                </div>
            </div>
        `;
        });
        $('#insert_estimateur_faq').html(faq_html);

        // Gestion du slideToggle
        $(document).on("click", ".faq-item", function () {
            $(this).find(".faq-answer").slideToggle(200).toggleClass('expand');
            $(this).find(".arrow").text(
                $(this).find(".faq-answer").hasClass("expand") ? "-" : "+"
            );
        });
    </script>






    <section id="contact">
        <h2>Passez à l'action !</h2>
        <p>Vous avez réussi à vous décider? Contactez-nous dès maintenant pour concrétiser votre demande
            et discuter d'un devis personnalisé
        </p>
        <button onclick="window.open('https://isotuiles.fr/pages/conctactez-nous')" class="btn-1">Nous
            contacter</button>
    </section>


    <p id="bug-review">Un bug, une suggestion ou une remarque sur notre estimateur de coût ? N'hésitez pas à nous
        contacter en <a href="mailto:isotuiles@gmail.com">cliquant ici</a></p>







    <script>
        function sendHeight() {
            const height = $('body').prop('scrollHeight');
            window.parent.postMessage({ frameHeight: height }, "*");
        }

        // Envoi initial
        $(window).on('load', sendHeight);

        // À chaque clic sur un bouton
        $('.maj_height').on('click', function () {
            setTimeout(sendHeight, 50);
        });

    </script>







    <script src="./estimateur_simple_prix.js"></script>
    <script src="./commande/order-form.js"></script>

    <script src="./export_pdf.js"></script>
</body>

</html>